"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([["76540"],{279837:function(e,t,n){n.d(t,{default:()=>d}),n(47120),n(773603);var s,i=n(200651),l=n(192379),o=n(481060),a=n(388032),r=n(204905);function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class c extends(s=l.PureComponent){render(){let{title:e,actionText:t,children:n,transitionState:s}=this.props,{error:h,isLoading:c,value:d}=this.state,u=l.Children.count(n)>0?(0,i.jsx)(o.Zbd,{type:o.Zbd.Types.WARNING,className:r.card,children:(0,i.jsx)(o.Text,{className:r.warning,variant:"text-md/normal",children:n})}):null;return(0,i.jsx)(o.Y0X,{transitionState:s,children:(0,i.jsxs)("form",{onSubmit:this.handleSubmit,children:[(0,i.jsx)(o.xBx,{separator:!1,children:(0,i.jsx)(o.X6q,{variant:"heading-lg/semibold",children:e})}),(0,i.jsxs)(o.hzk,{children:[u,(0,i.jsxs)(o.xJW,{title:a.intl.string(a.t["CIGa+/"]),className:r.spacing,children:[(0,i.jsx)(o.oil,{type:"password",autoComplete:"off",autoFocus:!0,value:d,onChange:this.handlePasswordChange}),null!=h&&""!==h?(0,i.jsxs)(o.Text,{variant:"text-xs/normal",color:"text-danger",className:r.error,children:[" ",h," "]}):null]})]}),(0,i.jsxs)(o.mzw,{children:[(0,i.jsx)(o.zxk,{type:"submit",disabled:c||0===d.length,children:null!=t?t:a.intl.string(a.t["cY+Ooa"])}),(0,i.jsx)(o.zxk,{onClick:this.handleCancel,look:o.zxk.Looks.LINK,color:o.zxk.Colors.PRIMARY,children:a.intl.string(a.t["ETE/oK"])})]})]})})}constructor(...e){super(...e),h(this,"state",{value:"",error:null,isLoading:!1}),h(this,"handleSubmit",e=>{e.preventDefault();let{value:t}=this.state,{handleSubmit:n,onClose:s,onError:i}=this.props;this.setState({isLoading:!0}),n(t).then(e=>s(null!=e?e:void 0),e=>{if(null!=e.body)null==i||i(e.body),!this.shouldSkipErrorMsgRender(e.body)&&(e.body.password?this.setState({error:e.body.password,isLoading:!1}):e.body.message&&this.setState({error:e.body.message,isLoading:!1}))}).finally(()=>this.setState({isLoading:!1}))}),h(this,"shouldSkipErrorMsgRender",e=>{let{skipErrorMsgAbortCode:t}=this.props;return null!=t&&(null==e?void 0:e.code)===t}),h(this,"handleCancel",()=>{let{onClose:e}=this.props;e()}),h(this,"handlePasswordChange",e=>{let{onPasswordChange:t}=this.props;null==t||t(e),this.setState({value:e})})}}h(c,"key",()=>"password-confirm-modal");let d=c},7557:function(e,t,n){n.d(t,{Z:()=>E}),n(47120),n(653041);var s,i,l=n(200651),o=n(192379),a=n(120356),r=n.n(a),h=n(600164),c=n(778888);function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class u extends(s=o.PureComponent){render(){let{className:e}=this.props;return(0,l.jsx)("input",{ref:this.setCodeBlockRef,className:r()(c.input,e),maxLength:1,value:null!=this.props.code?this.props.code:void 0,autoFocus:this.props.autoFocus,onKeyDown:this.handleKeyDown,onChange:this.handleChange})}focus(){var e;null===(e=this._codeBlockRef)||void 0===e||e.focus()}blur(){var e;null===(e=this._codeBlockRef)||void 0===e||e.blur()}constructor(...e){super(...e),d(this,"_codeBlockRef",void 0),d(this,"setCodeBlockRef",e=>{this._codeBlockRef=e}),d(this,"handleKeyDown",e=>{let t=8===e.which||37===e.which||39===e.which,n=e.which>=48&&e.which<=57||e.keyCode>=96&&e.keyCode<=105;t||n||e.preventDefault();let{onKeyDown:s}=this.props;null==s||s(e)}),d(this,"handleChange",e=>{let{onChange:t}=this.props;null==t||t(e.currentTarget.value)})}}d(u,"defaultProps",{autoFocus:!1});class p extends(i=o.PureComponent){render(){let{className:e,inputClassName:t}=this.props,{codes:n}=this.state,s=[];for(let e=0;e<n.length;e++)e===n.length/2&&s.push((0,l.jsx)("div",{className:c.spacer},"spacer")),s.push((0,l.jsx)(u,{ref:t=>this.setCodeBlockRef(e,t),code:n[e],autoFocus:0===e,onChange:t=>this.handleChange(e,t),onKeyDown:t=>this.handleKeyDown(e,t),className:t},e));return(0,l.jsx)(h.Z,{align:h.Z.Align.CENTER,justify:h.Z.Justify.CENTER,className:e,children:s})}setCodeBlockRef(e,t){this._codeBlockRefs[e]=t}handleChange(e,t){this.state.codes[e]=t;let n=this.getCodeOrFirstEmptyIndex();if("string"==typeof n)this.submit(n);else{let e=this._codeBlockRefs[n];null==e||e.focus()}}handleKeyDown(e,t){let{codes:n}=this.state;if(8===t.which&&e>0&&(null==n[e]||0===n[e].length)){let t=e-1;n[t]="";let s=this._codeBlockRefs[t];null==s||s.focus()}}getCodeOrFirstEmptyIndex(){let{codes:e}=this.state,t="";for(let n=0;n<e.length;n++){if(isNaN(parseInt(e[n])))return n;t+=e[n]}return t}submit(e){let{onSubmit:t}=this.props;null==t||t(e)}constructor(e){super(e),d(this,"_codeBlockRefs",Array(this.props.count)),this.state={codes:Array(e.count)}}}d(p,"defaultProps",{count:6});let E=p},317175:function(e,t,n){n.d(t,{Z:()=>g}),n(390547);var s=n(200651),i=n(192379),l=n(120356),o=n.n(l),a=n(658722),r=n.n(a),h=n(392711),c=n.n(h),d=n(217986),u=n(481060),p=n(600164),E=n(133080),m=n(388032),R=n(920178),C=n(801919);function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class g extends i.PureComponent{renderItems(){let{query:e}=this.state,t=d.Z.flatMap((e,t)=>{let{alpha2:n,phoneCountryCodes:i,name:l}=e,o=(0,E.q9)(n);return i.map(e=>({key:"".concat(t,"-").concat(e),name:l,translatedName:o,countryData:{name:l,alpha2:n,code:e},children:(0,s.jsxs)(p.Z,{className:R.countryItem,justify:p.Z.Justify.CENTER,align:p.Z.Align.CENTER,children:[(0,s.jsx)(p.Z.Child,{className:R.countryName,children:o}),(0,s.jsx)(p.Z.Child,{className:R.countryCode,grow:0,shrink:0,children:e})]})}))}),n=c()(t).filter(t=>0===e.length||r()(e.toLowerCase(),t.name.toLowerCase())||r()(e.toLowerCase(),t.translatedName.toLowerCase())).map(e=>(0,i.createElement)(u.mzC.Item,{...e,key:e.key,onClick:()=>this.onClick(e.countryData)})).value();return 0===n.length?(0,s.jsx)(u.mzC.Empty,{children:m.intl.string(m.t.PoWNfX)}):(0,s.jsx)(u.w0Z,{className:R.phoneFieldScroller,children:n})}render(){let{className:e}=this.props;return(0,s.jsxs)(u.mzC,{className:o()(R.phoneFieldPopout,C.elevationBorderLow,e),children:[(0,s.jsx)(u.mzC.SearchBar,{query:this.state.query,placeholder:m.intl.string(m.t.hGOODg),onChange:this.onChangeQuery,onClear:this.onClearQuery,autoComplete:"off"}),(0,s.jsx)(u.mzC.Divider,{}),this.renderItems()]})}constructor(e){super(e),f(this,"onChangeQuery",e=>{this.setState({query:e})}),f(this,"onClearQuery",()=>{this.setState({query:""})}),f(this,"onClick",e=>{var t,n;null===(t=(n=this.props).onClick)||void 0===t||t.call(n,e)}),this.state={query:""}}}},200357:function(e,t,n){n.d(t,{Z:()=>f}),n(47120);var s=n(200651),i=n(192379),l=n(120356),o=n.n(l),a=n(217986),r=n(481060),h=n(600164),c=n(259580),d=n(317175),u=n(388032),p=n(772840),E=n(801919),m=n(483938);function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class C extends i.PureComponent{render(){let{countryCode:e,phone:t,open:n}=this.state,{className:i,submitting:l}=this.props,[,a]=e.split("+");return(0,s.jsxs)(h.Z,{className:o()(p.phoneField,E.elevationLow,i),align:h.Z.Align.CENTER,grow:0,children:[(0,s.jsxs)(r.zxk,{size:r.PhG.SMALL,className:p.countryButton,color:r.Ttl.PRIMARY,innerClassName:p.countryButtonInner,onClick:this.handleTogglePopout,children:[(0,s.jsxs)(h.Z,{className:o()(p.countryCodeContainer,m.marginReset),justify:h.Z.Justify.CENTER,children:[(0,s.jsx)("div",{className:p.plusSign,children:"+"}),(0,s.jsx)("div",{className:p.countryCode,children:a})]}),(0,s.jsx)(c.Z,{foreground:p.phoneFieldExpand,expanded:n,width:16,height:16})]}),(0,s.jsx)("input",{"aria-label":u.intl.string(u.t["64bX0N"]),className:p.inputField,value:t,onChange:this.handleChange,onKeyPress:this.handleKeyPress,autoFocus:!0}),(0,s.jsx)(r.zxk,{className:p.sendButton,size:r.PhG.SMALL,submitting:l,onClick:this.handleSubmit,children:u.intl.string(u.t.TXNS7e)}),n?(0,s.jsx)(d.Z,{onClick:this.handleClick}):null]})}closePopout(){this.state.open&&this.setState({open:!1})}constructor(e){super(e),R(this,"handleChange",e=>{this.closePopout(),this.setState({phone:e.currentTarget.value})}),R(this,"handleKeyPress",e=>{this.closePopout(),13===e.which&&(e.preventDefault(),this.handleSubmit())}),R(this,"handleSubmit",()=>{let{onSubmit:e,submitting:t}=this.props,{countryCode:n,phone:s}=this.state;t||null==e||e("".concat(n).concat(s))}),R(this,"handleTogglePopout",()=>{this.setState({open:!this.state.open})}),R(this,"handleClick",e=>{let[t,n]=e.code.split(" ");this.setState({open:!1,countryCode:t,phone:null!=n?n:""})});let[t,n]=a.Z.find(e=>"United States"===e.name).phoneCountryCode.split(" ");this.state={countryCode:t,phone:null!=n?n:"",open:!1}}}let f=C},145454:function(e,t,n){n.d(t,{Z:()=>g}),n(47120);var s=n(200651),i=n(192379),l=n(120356),o=n.n(l),a=n(772848),r=n(990547),h=n(481060),c=n(600164),d=n(7557),u=n(200357),p=n(388032),E=n(468515),m=n(179683),R=n(483938);function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class f extends i.PureComponent{async componentDidMount(){let[e,{default:t}]=await Promise.all([n.e("93198").then(n.t.bind(n,140523,19)),Promise.resolve().then(n.t.bind(n,500923,23))]);null!=this._lottieRef&&(this._animItem=t.loadAnimation({container:this._lottieRef,renderer:"svg",loop:!0,autoplay:!1,animationData:e}))}componentWillUnmount(){null!=this._animItem&&(this._animItem.destroy(),this._animItem=void 0)}render(){let e,t,n;let{error:i,working:l,transitionState:a,validPhone:C}=this.props;return e=null!=i&&""!==i?(0,s.jsx)("div",{className:o()(E.description,E.error,R.marginBottom20),children:i}):C?(0,s.jsx)("div",{className:o()(E.description,R.marginBottom20),children:p.intl.string(p.t["4qMI6O"])}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:o()(E.description,R.marginBottom20),children:p.intl.string(p.t.Vp9je3)}),(0,s.jsx)("div",{className:o()(E.description,R.marginBottom20),children:p.intl.format(p.t["3BTmqa"],{})})]}),t=C?(0,s.jsxs)(c.Z,{className:E.field,direction:c.Z.Direction.VERTICAL,align:c.Z.Align.CENTER,children:[(0,s.jsx)(d.Z,{onSubmit:this.handleVerifyPhone}),(0,s.jsx)(h.zxk,{className:R.marginTop8,size:h.PhG.SMALL,look:h.iLD.LINK,color:h.Ttl.PRIMARY,onClick:this.handleResendCode,children:p.intl.string(p.t["5b60go"])})]}):(0,s.jsx)(u.Z,{className:E.field,onSubmit:this.handleAddPhone,submitting:l}),n=C?p.intl.string(p.t.Xclkxs):p.intl.string(p.t.uR76s7),(0,s.jsxs)(h.Y0X,{impression:{impressionName:r.ImpressionNames.USER_VERIFY_PHONE},transitionState:a,className:o()(E.phoneVerificationModal,m.vertical,m.alignCenter,m.justifyCenter,R.marginTop60),"aria-labelledby":this.headerId,children:[(0,s.jsx)("div",{className:E.animationContainer,ref:this.setLottieRef}),(0,s.jsx)("div",{className:o()(E.title,R.marginBottom8),id:this.headerId,children:n}),e,t]})}constructor(e){super(e),C(this,"_animItem",null),C(this,"_lottieRef",void 0),C(this,"headerId",(0,a.Z)()),C(this,"setLottieRef",e=>{this._lottieRef=e}),C(this,"handleAddPhone",e=>{this.state.animated||null==this._animItem?this.setState({phone:e}):(this._animItem.play(),this.setState({animated:!0,phone:e}));let{onAddPhone:t}=this.props;null==t||t(e)}),C(this,"handleVerifyPhone",e=>{let{onVerifyPhone:t}=this.props;null==t||t(e)}),C(this,"handleResendCode",()=>{let{onAddPhone:e}=this.props;null==e||e(this.state.phone)}),this.state={animated:!1,phone:""}}}let g=f},1964:function(e,t,n){n.d(t,{Z:()=>p});var s=n(392711),i=n.n(s),l=n(981631),o=n(388032);let{CAPTCHA:a,EMAIL:r,PHONE:h,REVERIFY_EMAIL:c,REVERIFY_PHONE:d}=l.PUi,u={[l.c2C.REQUIRE_VERIFIED_EMAIL]:[r],[l.c2C.REQUIRE_VERIFIED_PHONE]:[h],[l.c2C.REQUIRE_REVERIFIED_EMAIL]:[c],[l.c2C.REQUIRE_REVERIFIED_PHONE]:[d],[l.c2C.REQUIRE_VERIFIED_EMAIL_OR_VERIFIED_PHONE]:[r,h],[l.c2C.REQUIRE_REVERIFIED_EMAIL_OR_VERIFIED_PHONE]:[h,c],[l.c2C.REQUIRE_VERIFIED_EMAIL_OR_REVERIFIED_PHONE]:[r,d],[l.c2C.REQUIRE_REVERIFIED_EMAIL_OR_REVERIFIED_PHONE]:[c,d],[l.c2C.REQUIRE_CAPTCHA]:[a],[l.c2C.AGREEMENTS]:[]},p={isPhoneReverification:(e,t)=>void 0!==e&&e.isPhoneVerified()&&(t===l.c2C.REQUIRE_REVERIFIED_PHONE||t===l.c2C.REQUIRE_REVERIFIED_EMAIL_OR_REVERIFIED_PHONE||t===l.c2C.REQUIRE_VERIFIED_EMAIL_OR_REVERIFIED_PHONE),isEmailReverification:e=>e===l.c2C.REQUIRE_REVERIFIED_EMAIL||e===l.c2C.REQUIRE_REVERIFIED_EMAIL_OR_REVERIFIED_PHONE||e===l.c2C.REQUIRE_REVERIFIED_EMAIL_OR_VERIFIED_PHONE,getVerificationTypes:e=>null==e||"symbol"==typeof e?[]:u[e],getButtonTitle(e){switch(e){case l.PUi.EMAIL:return o.intl.string(o.t["1MPz29"]);case l.PUi.PHONE:return o.intl.string(o.t.mjJecn);case l.PUi.REVERIFY_EMAIL:return o.intl.string(o.t.nmdPFR);case l.PUi.REVERIFY_PHONE:return o.intl.string(o.t.of2129);default:return o.intl.string(o.t["oF6+W1"])}},areVerificationTypesEqual:(e,t)=>i().isEqual(e,t)}},607018:function(e,t,n){n.d(t,{default:()=>E}),n(47120);var s=n(200651),i=n(192379),l=n(442837),o=n(279837),a=n(479531),r=n(144114),h=n(145454),c=n(23434),d=n(594174),u=n(1964),p=n(388032);let E=i.forwardRef(function(e,t){let{onAddedPhone:n,onClose:E,transitionState:m,reason:R}=e,C=(0,l.e7)([d.default],()=>d.default.getCurrentUser()),f=(0,l.e7)([c.Z],()=>c.Z.getAction()),[g,I]=i.useState(null),[y,_]=i.useState(null),[x,P]=i.useState(null),[N,b]=i.useState(!1),v=i.useCallback(async e=>{b(!0);try{u.Z.isPhoneReverification(C,f)?await r.Z.beginReverifyPhone(e,R):await r.Z.beginAddPhone(e,R),P(null),I(e)}catch(e){P(new a.Z(e))}b(!1)},[C,R,f]),j=i.useCallback(async e=>{if(null!=g&&null!=C){b(!0);try{let{token:t}=await r.Z.verifyPhone(g,e);P(null),_(t)}catch(e){P(new a.Z(e))}b(!1)}},[C,g]),k=i.useCallback(async e=>{null!=y&&(u.Z.isPhoneReverification(C,f)?await r.Z.reverifyPhone(y,e,R):await r.Z.addPhone(y,e,R),null==n||n(),E())},[n,E,y,R,C,f]);return null!=y?(0,s.jsx)(o.default,{onClose:E,transitionState:m,title:p.intl.string(p.t.ZtCDc3),handleSubmit:k}):(0,s.jsx)(h.Z,{onClose:E,transitionState:m,error:null==x?void 0:x.getAnyErrorMessage(),working:N,validPhone:null!=g,onAddPhone:v,onVerifyPhone:j})})}}]);
//# sourceMappingURL=7b58fa0b3566f5ca.js.map