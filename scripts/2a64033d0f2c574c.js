"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([["66711"],{887706:function(n,t,e){e.d(t,{Z:()=>a});var l=e(399606),i=e(314897);function a(){return(0,l.e7)([i.default],()=>i.default.isAuthenticated())}},601911:function(n,t,e){e.d(t,{y:()=>i});var l=e(591759);function i(n,t){let e=n.getIconSource(t);if(null!=e&&"number"!=typeof e){let n;if(Array.isArray(e)?e.length>0&&(n=e[0].uri):n=e.uri,null!=n){var i;return null!==(i=l.Z.toURLSafe(n))&&void 0!==i?i:void 0}}}},110742:function(n,t,e){e.d(t,{M:()=>a}),e(47120);var l=e(442837),i=e(580130);function a(n){return(0,l.e7)([i.Z],()=>{let t=i.Z.getForSku(n);if(null==t)return!1;let e=0;for(let n of t){var l,a;let t=null!==(a=null===(l=n.endsAt)||void 0===l?void 0:l.getTime())&&void 0!==a?a:1/0;t>=e&&(e=t)}return e>new Date().getTime()},[n])}},680005:function(n,t,e){e.d(t,{YG:()=>g,pV:()=>Z,rf:()=>S});var l,i=e(200651);e(192379);var a=e(860911),r=e(481060),s=e(100527),u=e(906732),o=e(887706),d=e(929011),c=e(703656),p=e(626135),f=e(937615),v=e(110742),m=e(981631),I=e(388032),h=e(641875),S=((l={})[l.AVAILABLE=0]="AVAILABLE",l[l.LOADING=1]="LOADING",l[l.UPCOMING_PLAN=2]="UPCOMING_PLAN",l[l.SUBSCRIBED=3]="SUBSCRIBED",l[l.UNAVAILABLE=4]="UNAVAILABLE",l);function Z(n){let{appId:t,className:e,onClick:l,onHasClicked:a,skuId:r,subscriptionPlan:s,icon:u,state:o=0}=n,d=null!=s?(0,f.xg)(s):null,c=1===o;return 0===o||c?(0,i.jsx)(E,{appId:t,skuId:r,onClick:n=>{l(n),null==a||a()},className:e,submitting:c,children:(0,i.jsxs)("div",{className:h.btnContent,children:[u,null!=d?I.intl.formatToPlainString(I.t.i4T8v7,{rate:d}):I.intl.string(I.t.uuzaAA)]})}):(0,i.jsx)(A,{className:e,children:function(n,t){switch(n){case 2:return I.intl.formatToPlainString(I.t.k1ew5O,{rate:t});case 3:return I.intl.formatToPlainString(I.t["Hs3Y+P"],{rate:t});case 4:return I.intl.string(I.t.DLAKbm)}}(o,null!=d?d:"")})}function g(n){let{appId:t,className:e,onClick:l,onHasClicked:a,sku:r,icon:o}=n,{analyticsLocations:c}=(0,u.ZP)(s.Z.APP_STOREFRONT),p=()=>{(0,d.r)({appId:t,skuId:r.id,analyticsLocations:c})},S=(0,v.M)(r.id),Z=r.type===m.epS.DURABLE&&S,{price:g}=r;return null==g?null:Z?(0,i.jsx)(A,{className:e,children:I.intl.string(I.t["/bUsx8"])}):(0,i.jsx)(E,{appId:t,skuId:r.id,onClick:n=>{(null!=l?l:p)(n),null==a||a()},className:e,children:(0,i.jsxs)("div",{className:h.btnContent,children:[o,I.intl.format(I.t.Xp5WTk,{price:(0,f.T4)(g.amount,g.currency)})]})})}function E(n){let{appId:t,skuId:e,onClick:l,...s}=n,u=(0,o.Z)();return(0,i.jsx)(r.zxk,{...s,onClick:n=>{if(p.default.track(m.rMx.STOREFRONT_PURCHASE_CLICKED,{application_id:t,sku_id:e}),!u){n.preventDefault(),n.stopPropagation();let l=m.Z5c.GLOBAL_DISCOVERY_APPS_PROFILE_STORE_SKU(t,e),i=(0,a.Ui)(l,!1);(0,c.uL)(i);return}null==l||l(n)}})}function A(n){let{className:t,children:e}=n;return(0,i.jsx)(r.zxk,{disabled:!0,className:t,look:r.zxk.Looks.OUTLINED,color:r.zxk.Colors.PRIMARY,children:e})}},724870:function(n,t,e){e.d(t,{h:()=>h,m:()=>Z}),e(789020);var l=e(200651);e(192379);var i=e(512722),a=e.n(i),r=e(772848),s=e(481060),u=e(496929),o=e(159351),d=e(667),c=e(171246),p=e(509545),f=e(55563),v=e(626135),m=e(987209),I=e(981631);function h(n){let{initialPlanId:t,activeSubscription:i,analyticsObject:a,analyticsLocation:u,analyticsLocations:c,analyticsSubscriptionType:p,renderHeader:f,planGroup:h,skuId:S,guildId:Z,reviewWarningMessage:g,applicationId:E,showBenefitsFirst:A,onComplete:b,forcesTransitionToGuild:x}=n,N=(0,r.Z)(),L=!1;(0,s.ZDy)(async()=>{let{PaymentContextProvider:n}=await Promise.resolve().then(e.bind(e,563132)),r=(await e.e("7458").then(e.bind(e,405083))).default,{getApplicationPaymentSteps:s}=await e.e("86513").then(e.bind(e,759386)),o=s({guildId:Z,showBenefitsFirst:A});return e=>(0,l.jsx)(n,{loadId:N,applicationId:E,activeSubscription:i,stepConfigs:o,skuIDs:[S],children:(0,l.jsx)(m.KB,{children:(0,l.jsx)(r,{...e,initialPlanId:t,skuId:S,analyticsLocations:c,analyticsObject:a,analyticsLocation:u,analyticsSubscriptionType:p,renderHeader:f,planGroup:h,reviewWarningMessage:g,applicationId:E,guildId:null!=Z?Z:void 0,onComplete:()=>{L=!0,null==b||b()},forcesTransitionToGuild:x})})})},{onCloseCallback:()=>{L||(v.default.track(I.rMx.PAYMENT_FLOW_CANCELED,{load_id:N,payment_type:I.Zuq[I.GZQ.SUBSCRIPTION],location:null!=u?u:a,is_gift:!1,sku_id:S,application_id:E,location_stack:c}),(0,o.fw)(),(0,d.p)())},onCloseRequest:I.dG4})}let S=async(n,t)=>{let e=(await (0,u.yD)(n)).filter(n=>null==n.ends_at||new Date(n.ends_at)>new Date).find(n=>n.sku_id===t);a()(null==e,"User already has an active subscription to this SKU")};async function Z(n){var t;let{applicationId:e,skuId:l,initialPlanId:i,analyticsLocationObject:r,analyticsLocations:s,renderHeader:u}=n,o=f.Z.get(l),d=p.Z.getForSKU(l);a()(null!=o,"Failed to find SKU");let v=(0,c.KW)(o.flags);a()(v,"Guild application subscriptions unsupported!"),await S(e,l),h({initialPlanId:null!=i?i:null===(t=d[0])||void 0===t?void 0:t.id,activeSubscription:null,analyticsLocations:s,analyticsLocationObject:r,analyticsSubscriptionType:I.NYc.APPLICATION,renderHeader:u,planGroup:[],skuId:l,guildId:null,showBenefitsFirst:!1,applicationId:e})}},87484:function(n,t,e){e.d(t,{Z:()=>d});var l=e(200651);e(192379);var i=e(772848),a=e(481060),r=e(159351),s=e(667),u=e(626135),o=e(981631);function d(n){let{applicationId:t,skuId:d,onClose:c,onComplete:p,analyticsLocations:f,analyticsLocationObject:v,contextKey:m}=n,I=!1,h=(0,i.Z)();(0,a.ZDy)(async()=>{let{default:n}=await e.e("61670").then(e.bind(e,409600));return e=>{let{onClose:i,...a}=e;return(0,l.jsx)(n,{...a,loadId:h,applicationId:t,skuId:d,analyticsLocations:f,analyticsLocationObject:v,onClose:n=>{i(),null==c||c(n)},onComplete:n=>{I=!0,null==p||p(n)}})}},{contextKey:m,onCloseCallback:()=>{I||u.default.track(o.rMx.PAYMENT_FLOW_CANCELED,{load_id:h,payment_type:o.Zuq[o.GZQ.ONE_TIME],location:v,is_gift:!1,sku_id:d,application_id:t,location_stack:f}),(0,r.fw)(),(0,s.p)(),null==c||c(I)},onCloseRequest:o.dG4})}},270144:function(n,t,e){e.d(t,{CR:()=>x,E8:()=>k,Ev:()=>L,LM:()=>g,cr:()=>C,ec:()=>N,h6:()=>E,jd:()=>Z,qz:()=>b,sp:()=>A}),e(653041),e(47120),e(773603),e(789020);var l,i=e(192379),a=e(442837),r=e(496929),s=e(430824),u=e(496675),o=e(509545),d=e(78839),c=e(55563),p=e(801249),f=e(106976),v=e(307643),m=e(488915),I=e(171246),h=e(981631);let S=12633==e.j?2592e6:null;var Z=((l={})[l.NOT_LOADED=0]="NOT_LOADED",l[l.LOADING=1]="LOADING",l[l.LOADED=2]="LOADED",l[l.ERROR=3]="ERROR",l);let g=n=>{let{guildId:t,canFetch:e=!0,forceRefetch:l=!1}=n,r=(0,a.e7)([m.Z],()=>null!=t?m.Z.getEntitlementsForGuildFetchState(t):null,[t]);return i.useEffect(()=>{if(null==t||t===h.ME)return;let n=m.Z.getEntitlementsForGuildFetchState(t);e&&(n===m.M.NOT_FETCHED||l)&&(0,f.i1)(t)},[t,e,l]),{entitlementsLoaded:r===m.M.FETCHED}};function E(n){var t;let e=null!==(t=null==n?void 0:n.id)&&void 0!==t?t:h.lds,{entitlementsLoaded:l}=g({guildId:e,canFetch:(0,a.e7)([u.Z],()=>u.Z.can(h.Plq.ADMINISTRATOR,n))}),r=(0,a.e7)([p.Z],()=>p.Z.getLastGuildDismissedTime(e)),s=(0,a.Wu)([m.Z],()=>{let n=m.Z.getEntitlementsForGuild(e),t=m.Z.getEntitlementsForGuild(e,!1),l=n.map(n=>n.applicationId);return t.filter(n=>!l.includes(n.applicationId))}),o=(0,a.cj)([c.Z],()=>c.Z.getSKUs()),d=i.useMemo(()=>s.filter(n=>{let t=o[n.skuId];return null!=t&&t.available}),[s,o]);return l?d.filter(n=>null!=n.endsAt&&n.endsAt.getTime()>Math.max(null!=r?r:0,Date.now()-S)):[]}let A=n=>{let[t,e]=i.useState(!1),l=i.useMemo(()=>n.map(I.bZ),[n]);return i.useEffect(()=>{e(!0),Promise.all(l.map(n=>(0,f.vY)(n))).catch(()=>{}).then(()=>{e(!1)})},[l]),{loading:t}},b=()=>{let[n,t]=i.useState(0);return i.useEffect(()=>{t(1),Promise.all([(0,r.p0)({withSku:!0,withApplication:!0,entitlementType:h.qc2.APPLICATION_SUBSCRIPTION}),(0,r.p0)({withSku:!0,withApplication:!0,entitlementType:h.qc2.PURCHASE})]).catch(()=>{t(3)}).then(()=>{t(2)})},[]),{loadState:n}};function x(n,t){let e=!(arguments.length>2)||void 0===arguments[2]||arguments[2],[l,r]=i.useState([]),[u,o]=i.useState(!1);return i.useLayoutEffect(()=>{null!=n&&e&&(o(!0),(0,v.tn)(n,t).then(r).finally(()=>{o(!1)}))},[n,t,e]),{guilds:(0,a.Wu)([s.Z],()=>l.map(n=>s.Z.getGuild(n)).filter(n=>null!=n),[l]),isFetching:u}}let N=n=>n.items;function L(n,t){return T(n,t,N)}let P=n=>{var t,e;return null!==(e=null===(t=n.renewalMutations)||void 0===t?void 0:t.items)&&void 0!==e?e:[]};function C(n,t){return T(n,t,P)}function T(n,t,e){let[l,r]=(0,a.Wu)([d.ZP,o.Z],()=>null==n?[]:k({groupSku:n,SubscriptionStore:d.ZP,SubscriptionPlanStore:o.Z,mapSubscriptionItems:e,guildId:t}),[n,e,t]);return i.useMemo(()=>{if(null!=l&&null!=r)return{subscription:l,subscriptionPlan:r}},[l,r])}function k(n){var t,e;let{groupSku:l,SubscriptionStore:i,SubscriptionPlanStore:a,mapSubscriptionItems:r,guildId:s}=n,{bundledSkuIds:u,flags:o}=l;for(let n of null!==(t=i.getActiveApplicationSubscriptions())&&void 0!==t?t:[]){if((0,I.KK)(o)&&null!=s&&(null===(e=n.metadata)||void 0===e?void 0:e.application_subscription_guild_id)!==s)continue;let t=r(n).map(n=>a.get(n.planId)).find(n=>null!=n&&u.includes(n.skuId));if(null!=t)return[n,t]}return[]}},930155:function(n,t,e){e.d(t,{H:()=>s}),e(47120),e(411104);var l=e(192379),i=e(442837),a=e(821849),r=e(509545);function s(n){let[t,e]=l.useState(!1),s=(0,i.Wu)([r.Z],()=>r.Z.getForSKU(n),[n]),u=(0,i.e7)([r.Z],()=>r.Z.isFetchingForSKU(n),[n]);return l.useEffect(()=>{r.Z.isFetchingForSKU(n)||(e(!1),(0,a.GZ)(n).then(()=>{e(!1)}).catch(()=>{e(!0)}))},[n]),{data:s,isLoading:u,error:t?Error("SubscriptionPlans failed to fetch"):void 0}}},929011:function(n,t,e){e.d(t,{H:()=>v,r:()=>m}),e(789020),e(47120);var l=e(200651),i=e(481060),a=e(724870),r=e(87484),s=e(509545),u=e(78839),o=e(55563),d=e(270144),c=e(171246),p=e(689011),f=e(981631);async function v(n){let{subscriptionPlanId:t,sku:r,subscriptionGroupPlanIds:v,initialSubscribeForGuild:m,analyticsLocations:I,analyticsLocation:h,disableGuildSelector:S=!1}=n,{promise:Z,resolve:g}=Promise.withResolvers();if((0,c.KK)(r.flags)&&!1===S){let{promise:n,resolve:t}=Promise.withResolvers();(0,i.ZDy)(async()=>{let{GuildSubscriptionSelectionModal:n}=await e.e("43889").then(e.bind(e,279875));return e=>(0,l.jsx)(n,{transitionState:e.transitionState,onClose:e.onClose,sku:r,onSelect:t,currentGuildId:m})}),m=await n}let E=o.Z.getParentSKU(r.id),A=null;return null!=E&&([A]=(0,d.E8)({groupSku:E,SubscriptionStore:u.ZP,SubscriptionPlanStore:s.Z,mapSubscriptionItems:d.ec,guildId:m})),(0,a.h)({initialPlanId:t,skuId:r.id,activeSubscription:A,applicationId:r.applicationId,planGroup:v,guildId:m,renderHeader:(n,t,e)=>(0,l.jsx)(p.t,{step:e,onClose:()=>t(!1)}),analyticsSubscriptionType:f.NYc.APPLICATION,analyticsLocations:I,analyticsLocation:h,onComplete:g,showBenefitsFirst:!1,forcesTransitionToGuild:!1}),Z}function m(n){let{appId:t,skuId:e,analyticsLocations:l}=n;(0,r.Z)({applicationId:t,skuId:e,analyticsLocations:l})}},263519:function(n,t,e){e.d(t,{Z:()=>g}),e(390547),e(789020);var l=e(192379),i=e(512722),a=e.n(i),r=e(442837),s=e(570140),u=e(821849),o=e(906732),d=e(887706),c=e(680005),p=e(728345),f=e(509545),v=e(55563),m=e(551428),I=e(270144),h=e(488915),S=e(171246),Z=e(929011);function g(n){var t,e;let{initialSubscribeForGuild:i,analyticsLocation:g,skuId:E,onComplete:A,disableGuildSelector:b}=n,x=(0,r.e7)([v.Z],()=>null!=E?v.Z.get(E):void 0,[E]),N=(0,r.e7)([m.Z],()=>null!=E?m.Z.getForSKU(E):void 0,[E]),L=null===(t=(0,r.Wu)([f.Z],()=>null!=E?f.Z.getForSKU(E):[],[E])[0])||void 0===t?void 0:t.id,P=(0,r.e7)([v.Z],()=>null!=E?v.Z.getParentSKU(E):void 0,[E]),C=null==P?void 0:P.bundledSkuIds,T=(0,r.Wu)([f.Z],()=>{var n;return null!==(n=null==C?void 0:C.flatMap(f.Z.getForSKU))&&void 0!==n?n:[]},[C]),k=l.useMemo(()=>T.map(n=>n.id),[T]),_=(0,S.KK)(null!==(e=null==x?void 0:x.flags)&&void 0!==e?e:0),O=(0,r.e7)([h.Z],()=>null!=i&&!1!==_&&h.Z.getEntitlementsForGuild(i,!0).some(n=>n.skuId===E),[_,E,i]),j=null==x?void 0:x.applicationId,y=(null==N?void 0:N.published)===!0&&(null==x?void 0:x.isAvailable())===!0,{app:R}=(0,p.Rt)(j),{analyticsLocations:F}=(0,o.ZP)(),D=(0,I.Ev)(P,null!=i?i:void 0),U=null==D?void 0:D.subscription,G=null==D?void 0:D.subscriptionPlan,M=(0,I.cr)(P,null!=i?i:void 0),w=null==M?void 0:M.subscriptionPlan,{entitlementsLoaded:K}=(0,I.LM)({guildId:i});null==i&&(K=!0);let B=(0,d.Z)(),W=null!=U&&(0,S.Jf)(U,x),Y=l.useMemo(()=>{if(!K||null==R||null==E)return c.rf.LOADING;if(!y)return c.rf.UNAVAILABLE;if(!_){if((null==G?void 0:G.skuId)===E)return c.rf.SUBSCRIBED;if((null==w?void 0:w.skuId)===E&&!1===W)return c.rf.UPCOMING_PLAN}return c.rf.AVAILABLE},[null==G?void 0:G.skuId,y,R,K,W,_,null==w?void 0:w.skuId,E]);return l.useEffect(()=>{y&&null!=E&&B&&!(f.Z.isFetchingForSKU(E)||f.Z.isLoadedForSKU(E))&&s.Z.wait(()=>{(0,u.GZ)(E)})},[y,E,B]),{openModal:l.useCallback(()=>{a()(null!=R,"No application"),a()(null!=E,"No SKU ID"),a()(y,"Cannot purchase this unpublished plan"),(0,Z.H)({subscriptionPlanId:L,sku:x,subscriptionGroupPlanIds:k,initialSubscribeForGuild:i,disableGuildSelector:b,analyticsLocations:F,analyticsLocation:g}).then(()=>{null==A||A()})},[R,E,y,L,x,k,i,b,F,g,A]),subscriptionPurchaseButtonState:Y,isGuildSubscribed:O}}},269210:function(n,t,e){e.d(t,{Gm:()=>m,Uj:()=>v,ZI:()=>f});var l=e(200651);e(192379);var i=e(557533),a=e.n(i),r=e(489948),s=e(368072),u=e(777207),o=e(692547),d=e(330711),c=e(163177),p=e(236715);let f=5;function v(n){let{description:t,imgSrc:e,renderPurchaseButton:i,onPurchase:v,title:m,onDetails:I,benefitItems:h,benefitsSummary:S,subtitle:Z,maxBenefits:g=f}=n;return(0,l.jsx)(r.tE,{children:(0,l.jsxs)("div",{className:a()(c.container,p.hoverCard),tabIndex:0,onClick:()=>{null!=I?I():null!=v&&v()},children:[(0,l.jsx)("div",{className:c.card,children:(0,l.jsxs)("div",{className:c.body,children:[(0,l.jsx)(u.x,{tag:"div",variant:"heading-lg/semibold",children:m}),(0,l.jsx)("div",{className:c.image,children:null!=e?(0,l.jsx)("img",{src:e.toString(),alt:""}):(0,l.jsx)(s.V,{color:o.Z.colors.ICON_PRIMARY,size:"custom",height:48,width:48})}),null!=i?i({className:c.purchaseBtn,onClick:n=>{n.stopPropagation(),null==v||v()}}):null,Z,null!=t&&""!==t&&(0,l.jsx)(u.x,{className:c.description,color:"text-normal",variant:"text-sm/medium",children:t})]})}),null!=S&&(0,l.jsx)("div",{className:c.benefitsSummary,children:(0,l.jsx)(u.x,{color:"interactive-normal",variant:"text-sm/medium",children:d.Z.Messages.STOREFRONT_BENEFITS_SUMMARY.format({count:S})})}),null!=h&&h.length>0&&(0,l.jsx)("div",{className:c.benefits,children:(0,l.jsx)("div",{className:c.benefitsContainer,children:(0,l.jsxs)("div",{className:c.benefitsList,children:[(0,l.jsx)(u.x,{color:"header-secondary",variant:"eyebrow",children:d.Z.Messages.STOREFRONT_BENEFITS_TITLE}),h.length>g?(0,l.jsxs)(l.Fragment,{children:[h.slice(0,g),(0,l.jsx)(u.x,{variant:"text-md/semibold",color:"text-secondary",children:d.Z.Messages.STOREFRONT_MORE_BENEFITS.format({count:h.length-g})})]}):h]})})})]})})}function m(n){let{icon:t,header:e,description:i}=n;return(0,l.jsxs)("div",{className:c.cardBenefit,children:[(0,l.jsx)("div",{className:c.cardBenefitIcon,children:t}),(0,l.jsxs)("div",{children:[null!=e&&(0,l.jsx)(u.x,{variant:"text-md/semibold",color:"header-primary",children:e}),(0,l.jsx)(u.x,{variant:"text-sm/normal",children:i})]})]})}}}]);
//# sourceMappingURL=2a64033d0f2c574c.js.map