"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([["3940"],{103879:function(t,e,n){n.d(e,{FN:()=>s,NA:()=>u,uR:()=>S,yq:()=>r});var i=n(544891),E=n(570140),l=n(406432),_=n(314897);n(236289);var a=n(788080);n(800530);var A=n(981631);async function r(){E.Z.dispatch({type:"SAFETY_HUB_FETCH_START"});let t=_.default.getSuspendedUserToken(),e=null!=t?A.ANM.SAFETY_HUB_SUSPENDED:A.ANM.SAFETY_HUB,n=null!=t?i.tn.post({url:e,body:{token:t},rejectWithError:!1}):i.tn.get({url:e,rejectWithError:!1});await n.then(t=>{let{body:e}=t,{classifications:n,guild_classifications:i,account_standing:l,is_dsa_eligible:_,username:a,is_appeal_eligible:A,appeal_eligibility:r}=e,u=n.map(t=>(o(t),t));E.Z.dispatch({type:"SAFETY_HUB_FETCH_SUCCESS",classifications:u.concat(null!=i?i:[]),accountStanding:l,isDsaEligible:_,username:a,isAppealEligible:A,appealEligibility:null!=r?r:[]})}).catch(t=>{var e,n;E.Z.dispatch({type:"SAFETY_HUB_FETCH_FAILURE",error:null!==(n=null==t?void 0:null===(e=t.body)||void 0===e?void 0:e.message)&&void 0!==n?n:"Unknown error"})})}async function u(t){E.Z.dispatch({type:"SAFETY_HUB_FETCH_CLASSIFICATION_START",classificationId:t});let e=_.default.getSuspendedUserToken(),n=null!=e?A.ANM.SAFETY_HUB_SUSPENDED:A.ANM.SAFETY_HUB,l=null!=e?i.tn.post({url:n,body:{token:e},rejectWithError:!1}):i.tn.get({url:n,rejectWithError:!1});await l.then(e=>{let{body:n}=e,{classifications:i,account_standing:l,is_dsa_eligible:_,username:a,is_appeal_eligible:A}=n,r=i.find(e=>e.id===t);null!=r?(o(r),E.Z.dispatch({type:"SAFETY_HUB_FETCH_CLASSIFICATION_SUCCESS",classification:r,accountStanding:l,isDsaEligible:_,username:a,isAppealEligible:A})):E.Z.dispatch({type:"SAFETY_HUB_FETCH_CLASSIFICATION_FAILURE",error:"Classification not found.",classificationId:t})}).catch(e=>{var n,i;E.Z.dispatch({type:"SAFETY_HUB_FETCH_CLASSIFICATION_FAILURE",error:null!==(i=null==e?void 0:null===(n=e.body)||void 0===n?void 0:n.message)&&void 0!==i?i:"Unknown error",classificationId:t})})}function o(t){if(null!=t.flagged_content&&t.flagged_content.length>0){let e=t.flagged_content[0];e.attachments=e.attachments.filter(t=>{let{filename:e}=t;return(0,l.CO)(e)||(0,l.NU)(e)}),t.flagged_content=(0,a.Vt)(e)?[]:[e]}}async function S(t,e,n){let l=_.default.getSuspendedUserToken(),a=null!=l?A.ANM.SAFETY_HUB_REQUEST_SUSPENDED_USER_REVIEW(t):A.ANM.SAFETY_HUB_REQUEST_REVIEW(t),r=null!=l?i.tn.put({url:a,body:{signal:e,user_input:n,token:l},rejectWithError:!1}):i.tn.put({url:a,body:{signal:e,user_input:n},rejectWithError:!1});E.Z.dispatch({type:"SAFETY_HUB_REQUEST_REVIEW_START"}),await r.then(()=>{E.Z.dispatch({type:"SAFETY_HUB_REQUEST_REVIEW_SUCCESS",classificationId:t})}).catch(t=>{var e,n;throw E.Z.dispatch({type:"SAFETY_HUB_REQUEST_REVIEW_FAILURE",error:null!==(n=null==t?void 0:null===(e=t.body)||void 0===e?void 0:e.message)&&void 0!==n?n:"Unknown error"}),t})}async function s(){E.Z.dispatch({type:"SAFETY_HUB_REQUEST_AUTOMATED_UNDERAGE_APPEAL_START"});let t=_.default.getSuspendedUserToken(),e=A.ANM.SAFETY_HUB_REQUEST_SUSPENDED_AGE_VERIFICATION,n=i.tn.post({url:e,body:{token:t},rejectWithError:!1});await n.then(t=>{let{body:e}=t,{verification_request_id:n,verification_webview_url:i}=e;E.Z.dispatch({type:"SAFETY_HUB_REQUEST_AUTOMATED_UNDERAGE_APPEAL_SUCCESS",verificationRequestId:n,verificationWebviewUrl:i})}).catch(t=>{var e,n;E.Z.dispatch({type:"SAFETY_HUB_REQUEST_AUTOMATED_UNDERAGE_APPEAL_FAILURE",error:null!==(n=null==t?void 0:null===(e=t.body)||void 0===e?void 0:e.message)&&void 0!==n?n:"Unknown error"})})}},364226:function(t,e,n){n.d(e,{A:()=>E});let i=(0,n(818083).B)({kind:"user",id:"2024-02_safety_hub_guild_violation_in_app_appeals",label:"Safety Hub Guild Violation In App Appeals",defaultConfig:{enabled:!1},treatments:[{id:1,label:"Allow guild violations to be applied using the new appeals ingestion flow",config:{enabled:!0}}]});function E(t){return!!i.useExperiment({location:t},{autoTrackExposure:!0}).enabled}},236289:function(t,e,n){n.d(e,{Z:()=>v});var i,E,l,_=n(979079),a=n.n(_),A=n(442837),r=n(570140),u=n(531441),o=n(800530);let S={},s={},c={state:u.Sn.ALL_GOOD},T=!1,U=!1,d=null,p=null,f=!1,g=!1,F=[],C=!1,I=null,R=o.bK.DIDNT_VIOLATE_POLICY,D="",L="",H="",N=0,O=null,b=!1,P=o.oE.NONE,Y=null;function B(t){let{}=t;H="",O=null,b=!1}class h extends(l=A.ZP.Store){isFetching(){return T}getClassifications(){return Object.values(S)}getClassification(t){return S[t]}getAccountStanding(){return c}getFetchError(){return d}isInitialized(){return U}getClassificationRequestState(t){return s[t]}getAppealClassificationId(){return p}getIsDsaEligible(){return f}getIsAppealEligible(){return g}getAppealEligibility(){return F}getAppealSignal(){return R}getFreeTextAppealReason(){return D}getIsSubmitting(){return C}getSubmitError(){return I}getUsername(){return L}getAgeVerificationWebviewUrl(){return H}getAgeVerificationError(){return O}getIsLoadingAgeVerification(){return b}getAgeCheckStatus(){return P}getAgeCheckError(){return Y}getAgeCheckAttempts(){return N}}E="SafetyHubStore",(i="displayName")in h?Object.defineProperty(h,i,{value:E,enumerable:!0,configurable:!0,writable:!0}):h[i]=E;let v=new h(r.Z,{SAFETY_HUB_FETCH_START:function(t){T=!0},SAFETY_HUB_FETCH_SUCCESS:function(t){let{classifications:e,accountStanding:n,isDsaEligible:i,isAppealEligible:E,username:l,appealEligibility:_}=t;S=a()(e,"id"),c=n,f=i,g=E,T=!1,U=!0,d=null,L=l,F=_},SAFETY_HUB_FETCH_FAILURE:function(t){let{error:e}=t;T=!1,U=!1,d=e},SAFETY_HUB_FETCH_CLASSIFICATION_START:function(t){s[t.classificationId]=u.OY.PENDING,T=!0},SAFETY_HUB_FETCH_CLASSIFICATION_SUCCESS:function(t){let{classification:e,accountStanding:n,isDsaEligible:i,username:E,isAppealEligible:l}=t;S[e.id]=e,s[e.id]=u.OY.SUCCESS,c=n,T=!1,d=null,f=i,g=l,U=!0,L=E},SAFETY_HUB_FETCH_CLASSIFICATION_FAILURE:function(t){let{error:e,classificationId:n}=t;T=!1,d=e,s[n]=u.OY.FAILED,U=!1},SAFETY_HUB_APPEAL_OPEN:function(t){let{classificationId:e}=t;p=e},SAFETY_HUB_APPEAL_CLOSE:function(){p=null,R=o.bK.DIDNT_VIOLATE_POLICY,D=""},SAFETY_HUB_APPEAL_SIGNAL_SELECT:function(t){let{signal:e}=t;R=e},SAFETY_HUB_APPEAL_SIGNAL_CUSTOM_INPUT_CHANGE:function(t){let{userInput:e}=t;D=e},SAFETY_HUB_REQUEST_REVIEW_START:function(t){let{}=t;C=!0,I=null},SAFETY_HUB_REQUEST_REVIEW_SUCCESS:function(t){let{classificationId:e}=t;C=!1,I=null,S[e].appeal_status={status:u.hQ.REVIEW_PENDING}},SAFETY_HUB_REQUEST_REVIEW_FAILURE:function(t){let{error:e}=t;C=!1,I=e},SAFETY_HUB_REQUEST_AUTOMATED_UNDERAGE_APPEAL_START:function(t){let{}=t;H="",O=null,b=!0},SAFETY_HUB_REQUEST_AUTOMATED_UNDERAGE_APPEAL_SUCCESS:function(t){let{verificationWebviewUrl:e}=t;H=e,O=null,b=!1},SAFETY_HUB_REQUEST_AUTOMATED_UNDERAGE_APPEAL_FAILURE:function(t){let{error:e}=t;H="",O=e,b=!1},SAFETY_HUB_AUTOMATED_UNDERAGE_APPEAL_MODAL_OPEN:B,SAFETY_HUB_AUTOMATED_UNDERAGE_APPEAL_MODAL_CLOSE:B,SAFETY_HUB_AUTOMATED_UNDERAGE_APPEAL_SUBMIT_SUCCESS:function(t){let{}=t;for(let t in P=o.oE.LOADING,S)S[t].is_coppa&&(S[t].appeal_status={status:u.hQ.REVIEW_PENDING})},SAFETY_HUB_AUTOMATED_UNDERAGE_APPEAL_START_POLL:function(t){let{}=t;P=o.oE.LOADING,Y=null},SAFETY_HUB_CHECK_AUTOMATED_UNDERAGE_APPEAL_START:function(t){let{}=t;P=o.oE.LOADING,Y=null,N+=1},SAFETY_HUB_CHECK_AUTOMATED_UNDERAGE_APPEAL_SUCCESS:function(t){let{success:e}=t;P=e?o.oE.SUCCESS:N<o.o6?o.oE.LOADING:o.oE.FAILURE,Y=null},SAFETY_HUB_CHECK_AUTOMATED_UNDERAGE_APPEAL_FAILURE:function(t){let{error:e}=t;P=o.oE.ERROR,Y=e},LOGOUT:function(){T=!1,S={},c={state:u.Sn.ALL_GOOD},p=null,R=o.bK.DIDNT_VIOLATE_POLICY,D="",F=[]}})},451284:function(t,e,n){n.d(e,{P:()=>l});var i=n(442837),E=n(236289);function l(){return(0,i.e7)([E.Z],()=>E.Z.getAccountStanding())}},613734:function(t,e,n){n.d(e,{KM:()=>T,U0:()=>U,YG:()=>s,y9:()=>c});var i=n(192379),E=n(442837),l=n(709054),_=n(103879),a=n(364226),A=n(531441),r=n(236289),u=n(788080),o=n(800530);function S(){return(0,E.Wu)([r.Z],()=>r.Z.getClassifications()).sort((t,e)=>l.default.extractTimestamp(e.id)-l.default.extractTimestamp(t.id))}function s(t){let e;let n=(0,E.e7)([r.Z],()=>r.Z.getClassification(t)),l=(0,E.e7)([r.Z],()=>r.Z.getClassificationRequestState(t)),S=(0,E.e7)([r.Z],()=>r.Z.getIsDsaEligible()),s=(0,E.e7)([r.Z],()=>r.Z.getIsAppealEligible()),c=(0,a.A)("classification_detail");if((0,u.FB)(n)){var T;e=(null===(T=n.guild_metadata)||void 0===T?void 0:T.member_type)===A.wO.OWNER?o.qS.GUILD_OWNER:o.qS.GUILD_MEMBER}else e=o.qS.USER;return i.useEffect(()=>{void 0===n&&null==l&&_.NA(t)},[t,n,l]),{classification:n,classificationRequestState:l,isDsaEligible:S,isAppealEligible:s&&null!=n&&null==n.appeal_status&&(!(0,u.FB)(n)||c),violationType:e}}function c(){let t=S(),e=new Date;return t.filter(t=>new Date(t.max_expiration_time)>e)}function T(){let t=S(),e=new Date;return t.filter(t=>new Date(t.max_expiration_time)<=e)}function U(){return(0,E.e7)([r.Z],()=>r.Z.getAppealSignal())}},846488:function(t,e,n){n.d(e,{e:()=>l});var i=n(442837),E=n(236289);function l(){return(0,i.e7)([E.Z],()=>E.Z.isInitialized())}},181211:function(t,e,n){n.d(e,{Z:()=>l});var i=n(442837),E=n(236289);function l(){return(0,i.e7)([E.Z],()=>E.Z.isFetching())}}}]);
//# sourceMappingURL=c20e6094cb5c893c.js.map