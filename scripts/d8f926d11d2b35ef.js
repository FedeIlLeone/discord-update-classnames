"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([["33862"],{139387:function(e,t,n){n.d(t,{Z:()=>I});var i=n(570140),l=n(434404),r=n(821864),T=n(308063);let I={init(){i.Z.dispatch({type:"INTEGRATION_SETTINGS_INIT"})},setSection(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;i.Z.dispatch({type:"INTEGRATION_SETTINGS_SET_SECTION",section:e,sectionId:t})},startEditingCommandPermissions(e){i.Z.dispatch({type:"INTEGRATION_SETTINGS_START_EDITING_COMMAND",commandId:e})},stopEditingCommandPermissions(e){i.Z.dispatch({type:"INTEGRATION_SETTINGS_STOP_EDITING_COMMAND",commandId:e})},startEditingIntegration(e){i.Z.dispatch({type:"INTEGRATION_SETTINGS_START_EDITING_INTEGRATION",integrationId:e})},stopEditingIntegration(){i.Z.dispatch({type:"INTEGRATION_SETTINGS_STOP_EDITING_INTEGRATION"})},updateIntegration(e){i.Z.dispatch({type:"INTEGRATION_SETTINGS_UPDATE_INTEGRATION",settings:e})},startEditingWebhook(e){i.Z.dispatch({type:"INTEGRATION_SETTINGS_START_EDITING_WEBHOOK",webhookId:e})},stopEditingWebhook(){i.Z.dispatch({type:"INTEGRATION_SETTINGS_STOP_EDITING_WEBHOOK"})},updateWebhook(e){i.Z.dispatch({type:"INTEGRATION_SETTINGS_UPDATE_WEBHOOK",settings:e})},async saveApplicationPermissions(e,t,n){try{i.Z.dispatch({type:"INTEGRATION_SETTINGS_SUBMITTING"}),await r.U3({applicationId:e,commandId:e,defaultEveryoneValue:!0,defaultEverywhereValue:!0,guildId:t,permissions:n}),i.Z.dispatch({type:"INTEGRATION_SETTINGS_SAVE_SUCCESS"})}catch(e){i.Z.dispatch({type:"INTEGRATION_SETTINGS_SAVE_FAILURE",errors:e.body})}},async saveIntegration(e,t){try{i.Z.dispatch({type:"INTEGRATION_SETTINGS_SUBMITTING"}),await l.Z.updateIntegration(e,t.id,t.expire_behavior,t.expire_grace_period,t.enable_emoticons),i.Z.dispatch({type:"INTEGRATION_SETTINGS_SAVE_SUCCESS"})}catch(e){i.Z.dispatch({type:"INTEGRATION_SETTINGS_SAVE_FAILURE",errors:e.body})}},async saveWebhook(e,t){try{i.Z.dispatch({type:"INTEGRATION_SETTINGS_SUBMITTING"}),await T.Z.update(e,t.id,t),i.Z.dispatch({type:"INTEGRATION_SETTINGS_SAVE_SUCCESS"})}catch(e){i.Z.dispatch({type:"INTEGRATION_SETTINGS_SAVE_FAILURE",errors:e.body})}}}},308063:function(e,t,n){n.d(t,{Z:()=>o});var i=n(392711),l=n.n(i),r=n(544891),T=n(570140),I=n(981631);let E=["Spidey Bot","Captain Hook"],o={fetchForGuild(e){T.Z.dispatch({type:"WEBHOOKS_FETCHING",guildId:e}),r.tn.get({url:I.ANM.GUILD_WEBHOOKS(e),oldFormErrors:!0,rejectWithError:!1}).then(t=>{let{body:n}=t;return T.Z.dispatch({type:"WEBHOOKS_UPDATE",guildId:e,webhooks:n})}).catch(t=>{let{body:n}=t;T.Z.dispatch({type:"WEBHOOKS_UPDATE",guildId:e,error:n.message})})},fetchForChannel(e,t){T.Z.dispatch({type:"WEBHOOKS_FETCHING",guildId:e,channelId:t}),r.tn.get({url:I.ANM.CHANNEL_WEBHOOKS(t),oldFormErrors:!0,rejectWithError:!0}).then(n=>{let{body:i}=n;return T.Z.dispatch({type:"WEBHOOKS_UPDATE",guildId:e,channelId:t,webhooks:i})}).catch(t=>{let{body:n}=t;T.Z.dispatch({type:"WEBHOOKS_UPDATE",guildId:e,error:n.message})})},create:(e,t,n)=>(null==n&&(n=E[l().random(0,E.length-1)]),r.tn.post({url:I.ANM.CHANNEL_WEBHOOKS(t),body:{name:n},oldFormErrors:!0,rejectWithError:!1}).then(t=>{let{body:n}=t;return T.Z.dispatch({type:"WEBHOOK_CREATE",guildId:e,webhook:n}),n})),delete:(e,t)=>r.tn.del({url:I.ANM.WEBHOOK(t),oldFormErrors:!0,rejectWithError:!1}).then(()=>{T.Z.dispatch({type:"WEBHOOK_DELETE",guildId:e,webhookId:t})}),update:(e,t,n)=>r.tn.patch({url:I.ANM.WEBHOOK(t),body:n,oldFormErrors:!0,rejectWithError:!1}).then(t=>{let{body:n}=t;return T.Z.dispatch({type:"WEBHOOK_UPDATE",guildId:e,webhook:n}),n})}},360606:function(e,t,n){let i,l;n.r(t),n.d(t,{default:()=>W}),n(653041),n(47120);var r,T,I,E=n(392711),o=n.n(E),N=n(442837),u=n(570140),a=n(308063),_=n(496675),S=n(855674),d=n(999382),c=n(981631);let s=[],O=[],p=null,G=null,A=null,h=!1,f=!1,R=c.QZA.CLOSED,Z={},y=!1,g=null;function C(e){let{section:t}=e;if(t!==c.pNK.INTEGRATIONS)return!1;if(null==i){let e=d.Z.getGuildId();null!=e&&(a.Z.fetchForGuild(e),h=!0),P(!1)}}function P(e){if(null!=(i=d.Z.getProps().guild)&&_.Z.can(c.Plq.MANAGE_GUILD,i)){let e=d.Z.getProps().integrations;null==e&&(f=!0),s=null!=e?e:[]}else s=[];if(O=null!=i&&_.Z.can(c.Plq.MANAGE_WEBHOOKS,i)?S.Z.getWebhooksForGuild(i.id):[],!e&&null!=G){let e=v(G.id);null!=e&&(G=e)}if(null!=A){let e=M(A.id);null!=e&&(A=e)}p=null,R=c.QZA.OPEN,Z={},y=!1}let D=o().debounce(()=>{y&&(null!=G?o().isEqual(G,v(G.id))&&(y=!1):null!=A&&o().isEqual(A,M(A.id))&&(y=!1),y||m.emitChange())},500);function v(e){return s.find(t=>{let{id:n}=t;return n===e})}function M(e){return O.find(t=>{let{id:n}=t;return n===e})}class b extends(r=N.ZP.Store){initialize(){this.waitFor(d.Z,S.Z,_.Z)}hasChanges(){return y}get guild(){return i}get integrations(){return s}get webhooks(){return O}get editedCommandId(){return p}get editedIntegration(){return G}get editedWebhook(){return A}get formState(){return R}getErrors(){return Z}getSection(){return null!=l?l:c.b4C.OVERVIEW}getSectionId(){return g}getIntegration(e){return v(e)}getWebhook(e){return M(e)}isFetching(){return f||h}showNotice(){return this.hasChanges()}getApplication(e){var t;return null===(t=s.find(t=>{var n;return(null===(n=t.application)||void 0===n?void 0:n.id)===e}))||void 0===t?void 0:t.application}}I="GuildSettingsIntegrationsStore",(T="displayName")in b?Object.defineProperty(b,T,{value:I,enumerable:!0,configurable:!0,writable:!0}):b[T]=I;let m=new b(u.Z,__OVERLAY__?{}:{INTEGRATION_SETTINGS_INIT:function(){return P(!1)},INTEGRATION_SETTINGS_SAVE_SUCCESS:function(){return P(!0)},GUILD_SETTINGS_INIT:C,GUILD_SETTINGS_SET_SECTION:C,INTEGRATION_SETTINGS_SET_SECTION:function(e){let{section:t,sectionId:n}=e;l=t,g=n},INTEGRATION_SETTINGS_START_EDITING_COMMAND:function(e){let{commandId:t}=e;p=t,G=null,A=null,Z={},y=!0},INTEGRATION_SETTINGS_STOP_EDITING_COMMAND:function(e){let{commandId:t}=e;if(null==p||p!==t)return!1;p=null,Z={},y=!1},INTEGRATION_SETTINGS_START_EDITING_INTEGRATION:function(e){let{integrationId:t}=e,n=v(t);if(null==n)return!1;G=n,p=null,A=null,Z={},y=!1},INTEGRATION_SETTINGS_STOP_EDITING_INTEGRATION:function(){G=null,Z={},y=!1},INTEGRATION_SETTINGS_UPDATE_INTEGRATION:function(e){let{settings:t}=e;if(null==G)return!1;G={...G},null!=t.enableEmoticons&&G.enable_emoticons!==t.enableEmoticons&&(G.enable_emoticons=t.enableEmoticons,y=!0),null!=t.expireBehavior&&G.expire_behavior!==t.expireBehavior&&(G.expire_behavior=t.expireBehavior,y=!0),null!=t.expireGracePeriod&&G.expire_grace_period!==t.expireGracePeriod&&(G.expire_grace_period=t.expireGracePeriod,y=!0),y&&D()},INTEGRATION_SETTINGS_UPDATE_WEBHOOK:function(e){let{settings:t}=e;if(null==A)return!1;A={...A},null!=t.name&&A.name!==t.name&&(A.name=t.name,y=!0),void 0!==t.avatar&&A.avatar!==t.avatar&&(A.avatar=t.avatar,y=!0),null!=t.channelId&&A.channel_id!==t.channelId&&(A.channel_id=t.channelId,y=!0),y&&D()},INTEGRATION_SETTINGS_START_EDITING_WEBHOOK:function(e){let{webhookId:t}=e,n=M(t);if(null==n)return!1;A=n,p=null,G=null,Z={},y=!1},INTEGRATION_SETTINGS_STOP_EDITING_WEBHOOK:function(){A=null,Z={},y=!1},GUILD_SETTINGS_CLOSE:function(){i=null,s=[],O=[],p=null,G=null,A=null,R=c.QZA.CLOSED,y=!1},GUILD_SETTINGS_LOADED_INTEGRATIONS:function(e){let{guildId:t,integrations:n}=e;if(null==i||t!==i.id||R===c.QZA.SUBMITTING)return!1;for(let e of(f=!1,n))if(null==s.find(t=>{let{id:n}=t;if(n===e.id)return!0})){var l,r;s.push(e),e.type===(null==G?void 0:G.type)&&(null===(l=e.account)||void 0===l?void 0:l.id)===(null===(r=G.account)||void 0===r?void 0:r.id)&&(G=e)}for(let e=s.length-1;e>=0;e--){let t=s[e],i=n.find(e=>{let{id:n}=e;if(n===t.id)return!0});if(null!=i){let n={...t,...i};(null==G?void 0:G.id)!==n.id||(!1===n.enabled?G=null:y||(G=n)),s[e]=n}else(null==G?void 0:G.id)===t.id&&(G=null),s.splice(e,1)}s=[...s],D()},WEBHOOKS_UPDATE:function(e){let{guildId:t,channelId:n,webhooks:l}=e;if(h=!1,null!=i&&t===i.id&&null!=l&&R!==c.QZA.SUBMITTING){for(let e=O.length-1;e>=0;e--){let t=O[e];if(null!=n&&(null==t?void 0:t.channel_id)!==n)continue;let i=l.find(e=>{let{id:n}=e;if(n===t.id)return!0});if(null!=i){let n={...t,...i};O[e]=n,y||(null==A?void 0:A.id)!==n.id||(A=n)}else(null==A?void 0:A.id)===t.id&&(A=null),O.splice(e,1)}for(let e of l)null==O.find(t=>{let{id:n}=t;if(n===e.id)return!0})&&O.push(e);O=[...O],D()}},INTEGRATION_SETTINGS_SUBMITTING:function(){R=c.QZA.SUBMITTING,Z={}},INTEGRATION_SETTINGS_SAVE_FAILURE:function(e){var t;if(R!==c.QZA.SUBMITTING)return!1;R=c.QZA.OPEN,Z=null!==(t=e.errors)&&void 0!==t?t:{}}}),W=m},821864:function(e,t,n){n.d(t,{I4:()=>a,Sn:()=>N,U3:()=>S,Ui:()=>_,W4:()=>o,gq:()=>u,kZ:()=>E});var i=n(544891),l=n(570140),r=n(555573),T=n(581364),I=n(981631);function E(){l.Z.dispatch({type:"INTEGRATION_PERMISSION_SETTINGS_CLEAR"})}function o(e,t,n){l.Z.dispatch({applicationId:e,commandId:t,permissions:n,type:"INTEGRATION_PERMISSION_SETTINGS_EDIT"})}function N(e,t){i.tn.get({url:I.ANM.GUILD_COMMANDS_FOR_APPLICATION(e,t),rejectWithError:!0}).then(n=>{l.Z.dispatch({type:"INTEGRATION_PERMISSION_SETTINGS_COMMANDS_FETCH_SUCCESS",applicationId:t,commands:n.body.application_commands,guildId:e,permissions:n.body.permissions})},()=>{l.Z.dispatch({type:"INTEGRATION_PERMISSION_SETTINGS_COMMANDS_FETCH_FAILURE",applicationId:t})})}async function u(e,t,n){let r=[];try{let l=await i.tn.get({url:I.ANM.APPLICATION_BOT_GUILD_COMMAND_PERMISSIONS(e,t,n),rejectWithError:!1});l.ok&&(r=l.body.permissions)}catch(i){if(404!==i.status){l.Z.dispatch({type:"INTEGRATION_PERMISSION_SETTINGS_APPLICATION_PERMISSIONS_FETCH_FAILURE",applicationId:e,commandId:n,guildId:t});return}}l.Z.dispatch({type:"INTEGRATION_PERMISSION_SETTINGS_COMMAND_UPDATE",applicationId:e,commandId:n,guildId:t,permissions:r})}function a(e){l.Z.dispatch({applicationId:e,type:"INTEGRATION_PERMISSION_SETTINGS_INIT"})}function _(e){l.Z.dispatch({commandId:e,type:"INTEGRATION_PERMISSION_SETTINGS_RESET"})}async function S(e){let{applicationId:t,commandId:n,defaultEveryoneValue:i,defaultEverywhereValue:I,guildId:E,permissions:o}=e,N=n===t?function(e,t,n,i){if(!n||!i)return t;let l={[e]:n,[(0,T.bD)(e)]:i};return t.filter(e=>{let t=l[e.id];return null==t||e.permission!==t})}(E,o,i,I):o,u=await r.dh(t,E,n,N);u.ok&&l.Z.dispatch({type:"INTEGRATION_PERMISSION_SETTINGS_COMMAND_UPDATE",applicationId:t,commandId:n,guildId:E,permissions:u.body.permissions})}},855674:function(e,t,n){let i;n.d(t,{Z:()=>O}),n(47120);var l,r,T,I=n(392711),E=n.n(I),o=n(442837),N=n(570140),u=n(308063);let a={},_={};function S(e,t){return null==t&&(t="guild"),"".concat(e,":").concat(t)}function d(e){return null!=a[e]||(a[e]={}),a[e]}function c(e){let{guildId:t,webhook:n}=e;d(t)[n.id]=n}class s extends(l=o.ZP.Store){isFetching(e,t){return null!=_[S(e,t)]}getWebhooksForGuild(e){return E().values(d(e))}getWebhooksForChannel(e,t){return E()(d(e)).values().filter(e=>e.channel_id===t).value()}get error(){return i}}T="WebhooksStore",(r="displayName")in s?Object.defineProperty(s,r,{value:T,enumerable:!0,configurable:!0,writable:!0}):s[r]=T;let O=new s(N.Z,{WEBHOOKS_UPDATE:function(e){let{guildId:t,channelId:n,webhooks:l,error:r}=e;if(null==l){null!=r?(i=r,delete _[S(t,n)]):null!=n&&null!=a[t]&&(i=null,u.Z.fetchForChannel(t,n));return}i=null;let T=[];null!=n&&(T=E()(d(t)).values().filter(e=>e.channel_id!==n).value());let I=a[t]={};T.concat(l).forEach(e=>I[e.id]=e),delete _[S(t,n)]},WEBHOOKS_FETCHING:function(e){let{guildId:t,channelId:n}=e;_[S(t,n)]=!0},WEBHOOK_CREATE:c,WEBHOOK_UPDATE:c,WEBHOOK_DELETE:function(e){let{guildId:t,webhookId:n}=e;delete d(t)[n]}})}}]);
//# sourceMappingURL=d8f926d11d2b35ef.js.map