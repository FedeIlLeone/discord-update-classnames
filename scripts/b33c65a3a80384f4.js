"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([["29345"],{812483:function(i,t,n){n.d(t,{Z:()=>e});let e=(0,n(818083).B)({kind:"user",id:"2024-02_cropped_avatar_desktop_notifications",label:"Cropped Avatar Desktop Notifications",defaultConfig:{enabled:!1},treatments:[{id:1,label:"Show circular cropped avatars in desktop notifications",config:{enabled:!0}}]})},759198:function(i,t,n){n.d(t,{Z:()=>r});var e=n(200651);n(192379);var o=n(120356),a=n.n(o),l=n(481060),s=n(271454);function r(i){let{className:t,color:n,...o}=i;return(0,e.jsx)(l.Text,{className:a()({[s.text]:null==n},t),color:n,...o})}},106371:function(i,t,n){n.d(t,{Z:()=>a});var e=n(818083);let o=(0,e.B)({kind:"user",id:"2024-08_reaction_push_notifications_user",label:"In App Notifications for Reactions",defaultConfig:{enableInAppNotifications:!1,enableNotificationsForAllReactions:!1},treatments:[{id:1,label:"Enable In App Notifications for Reactions (First Reaction)",config:{enableInAppNotifications:!0,enableNotificationsForAllReactions:!1}},{id:2,label:"Enable In App Notifications for Reactions (All Reactions)",config:{enableInAppNotifications:!0,enableNotificationsForAllReactions:!0}},{id:3,label:"Enable In App Notifications for Reactions (All Reactions)",config:{enableInAppNotifications:!0,enableNotificationsForAllReactions:!0}}]});(0,e.B)({kind:"guild",id:"2024-08_reaction_push_notifications_guild",label:"In App Notifications for Reactions (Guild)",defaultConfig:{enableInAppNotifications:!1},treatments:[{id:1,label:"Enable In App Notifications for Reactions",config:{enableInAppNotifications:!0}}]});let a=o},912101:function(i,t,n){n.d(t,{Z:()=>e}),n(654769);let e=n(654769).Z},654769:function(i,t,n){let e;n.d(t,{Z:()=>V}),n(47120),n(177593),n(773603);var o,a=n(392711),l=n.n(a),s=n(525654),r=n.n(s),d=n(579806),c=n(933557),u=n(710845),f=n(812483),h=n(460181),v=n(474873),I=n(135906),p=n(592125),N=n(292959),_=n(699516),b=n(246946),g=n(594174),w=n(626135),C=n(5192),m=n(358085),O=n(960048),T=n(998502),Z=n(981631);function A(i,t,n){return t in i?Object.defineProperty(i,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[t]=n,i}let k=m.isPlatformEmbedded&&(0,m.isWindows)(),F=k&&10>parseFloat(d.Z.os.release),P=!0;if(k&&!F){let[i,,t]=d.Z.os.release.split(".");P=parseInt(i)>10||parseInt(t)>=15063}let y=new u.Z("NotificationUtils"),E=k&&P||"Chrome"===r().name&&47>parseFloat(r().version)||"Firefox"===r().name&&52>parseFloat(r().version);async function S(){if(void 0===e){if(null===d.Z||void 0===d.Z?void 0:d.Z.features.supports("notifications"))try{e=await T.ZP.invoke("NOTIFICATIONS_GET_SETTINGS")}catch(i){y.warn("Fetching native notification settings failed with error: ",i),e=null}else e=null}return e}async function R(){let i=await S();return(null==i?void 0:i.authorizationStatus)==="authorized"&&(null==i?void 0:i.sound)===!0}function x(i,t){var n;return null!==(n=(0,I.Z)(null!=t?t:v.Z.getSoundpack())[i])&&void 0!==n?n:i}async function D(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(await R())try{await T.ZP.invoke("NOTIFICATIONS_SEND_NOTIFICATION",{sound:x(i,n)});return}catch(i){y.warn("Native notification sound failed with error: ",i)}(0,h.GN)(i,t,void 0,n)}let L=l().throttle(D,1e3,{leading:!0});function M(){T.ZP.flashFrame(!1)}k&&(window.addEventListener("focus",M),T.ZP.on("MAIN_WINDOW_FOCUS",M));let z=window.Notification;if(F){let i={};T.ZP.on("NOTIFICATION_CLICK",(t,n)=>{let e=i[n];null!=e&&(e.onclick(),e.close())}),T.ZP.send("NOTIFICATIONS_CLEAR"),o=class{static requestPermission(i){i()}close(){null!=i[this.id]&&(delete i[this.id],T.ZP.send("NOTIFICATION_CLOSE",this.id),this.onclose())}constructor(t,{body:n,icon:e}){A(this,"id",z._id++),A(this,"title",void 0),A(this,"body",void 0),A(this,"icon",void 0),A(this,"onshow",function(){}),A(this,"onclick",function(){}),A(this,"onclose",function(){}),this.title=t,this.body=n,this.icon=e,setImmediate(()=>this.onshow()),i[this.id]=this,T.ZP.send("NOTIFICATION_SHOW",{id:this.id,title:this.title,body:this.body,icon:this.icon})}},A(o,"permission","granted"),A(o,"_id",0),z=o}let B={};if(null===d.Z||void 0===d.Z?void 0:d.Z.features.supports("notifications"))try{T.ZP.on("NOTIFICATIONS_RECEIVED_RESPONSE",(i,t,n)=>{if("dismiss"===t)delete B[n];else{var e,o,a;let i=B[n];(null==i?void 0:null===(e=i.options)||void 0===e?void 0:e.omitClickTracking)||w.default.track(Z.rMx.NOTIFICATION_CLICKED,null==i?void 0:i.trackingProps),null==i||null===(a=i.options)||void 0===a||null===(o=a.onClick)||void 0===o||o.call(a)}}),T.ZP.invoke("NOTIFICATIONS_REMOVE_ALL_NOTIFICATIONS")}catch(i){y.warn("Native notification setup failed with error: ",i)}async function W(){if(null===d.Z||void 0===d.Z?void 0:d.Z.features.supports("notifications")){var i;return(null===(i=await S())||void 0===i?void 0:i.authorizationStatus)==="authorized"}return null!=z&&"granted"===z.permission}function U(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;i.includes("message")?L(i,t,n):D(i,t,n)}async function G(i){return b.Z.disableNotifications&&null==i.overrideStreamerMode||!await W()||m.isPlatformEmbedded&&!T.ZP.shouldDisplayNotifications()}let V={hasPermission:W,requestPermission:function(i){if(null===d.Z||void 0===d.Z?void 0:d.Z.features.supports("notifications"))try{T.ZP.invoke("NOTIFICATIONS_GET_AUTHORIZATION").then(t=>{i(t)}).catch(()=>{i(!1)}).finally(()=>{e=void 0});return}catch(i){y.warn("Native notification authorization failed with error: ",i)}null!=z&&z.requestPermission(async()=>{null!=i&&i(await W())})},showNotification:async function(i,t,n,e,o){var a,l,s,r;let d;if(await G(o)){null!=o.sound&&!1!==o.playSoundIfDisabled&&U(o.sound,null!==(a=o.volume)&&void 0!==a?a:1,o.soundpack);return}let u=null!==(l=null==o?void 0:o.tag)&&void 0!==l?l:null,h=await S(),v=(null==h?void 0:h.authorizationStatus)==="authorized",I=v&&(null==h?void 0:h.sound)===!0,b=i=>{var t;null===(t=o.onShown)||void 0===t||t.call(o),o.omitViewTracking||w.default.track(Z.rMx.NOTIFICATION_VIEWED,e),E&&setTimeout(()=>i.close(),5e3)};if(null==o.sound||I||U(o.sound,null!==(s=o.volume)&&void 0!==s?s:1,o.soundpack),f.Z.getCurrentConfig({location:"showNotification"}).enabled&&o.isUserAvatar&&null!=i&&(i=await function(i){let t=new Image;return t.src=i,t.crossOrigin="anonymous",new Promise((n,e)=>{t.onload=()=>{""!==t.src&&n(function(i){let t=document.createElement("canvas"),n=t.getContext("2d"),e=Math.min(i.width,i.height);t.width=e,t.height=e,null!=n&&(n.beginPath(),n.arc(e/2,e/2,e/2,0,2*Math.PI),n.closePath(),n.clip(),n.drawImage(i,(i.width-e)/2,(i.height-e)/2,e,e,0,0,e,e));let o=t.toDataURL();return t.remove(),o}(t))},t.onerror=t=>{O.Z.captureMessage("Failed to load notification avatar to circle crop: ".concat(t)),e(i)}})}(i)),v){let a={title:t,body:n};null!=i&&(a.icon=i),(null==o?void 0:o.sound)!=null&&(a.sound=x(o.sound,o.soundpack)),(null==o?void 0:o.tag)!=null&&(a.identifier=o.tag);let l="string"==typeof(null==e?void 0:e.guild_id)?e.guild_id:null,s="string"==typeof(null==e?void 0:e.channel_id)?e.channel_id:null,r="string"==typeof(null==e?void 0:e.notif_user_id)?e.notif_user_id:null;if(null!=s){a.threadIdentifier=s;let i=p.Z.getChannel(s);null!=i&&(a.groupName=(0,c.F6)(i,g.default,_.Z))}null!=r&&(a.senderIdentifier=r,null!=l&&(a.senderDisplayName=C.ZP.getName(l,s,g.default.getUser(r))));try{let i=await T.ZP.invoke("NOTIFICATIONS_SEND_NOTIFICATION",a);B[i]={options:o,trackingProps:e};let t={close(){try{T.ZP.invoke("NOTIFICATIONS_REMOVE_NOTIFICATIONS",[i])}catch(i){y.warn("Native notification removal failed with error: ",i)}}};return b(t),t}catch(i){y.warn("Native notification failed with error: ",i)}}null!=o.sound&&v&&U(o.sound,null!==(r=o.volume)&&void 0!==r?r:1,o.soundpack);let A={icon:i,body:n,tag:u,silent:!0};k&&N.Z.taskbarFlash&&T.ZP.flashFrame(!0);try{d=new z(t,A)}catch(i){return null}return(b(d),d.onclick=()=>{var i;m.isPlatformEmbedded?T.ZP.focus():(window.focus(),d.close()),o.omitClickTracking||w.default.track(Z.rMx.NOTIFICATION_CLICKED,e),null===(i=o.onClick)||void 0===i||i.call(o)},P)?d:{close(){var i;null==d||null===(i=d.onclose)||void 0===i||i.call(d)}}},disabled:G,playNotificationSound:D}},437162:function(i,t,n){i.exports={rootContainer:"rootContainer_f4adbd",headerContainer:"headerContainer_f4adbd",text:"text_f4adbd",newBadge:"newBadge_f4adbd",nitroWheel:"nitroWheel_f4adbd",labelContainer:"labelContainer_f4adbd",playButton:"playButton_f4adbd",mutedLabel:"mutedLabel_f4adbd"}},271454:function(i,t,n){i.exports={text:"text__87e56"}},775364:function(i,t,n){i.exports={videoPaused:"videoPaused_afb275",warningCircle:"warningCircle_afb275"}}}]);
//# sourceMappingURL=b33c65a3a80384f4.js.map