"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([["67127"],{294596:function(e){e.exports="/assets/f9951f6f63451f68.svg"},188003:function(e){e.exports="/assets/1243734d7e2a4654.png"},579055:function(e){e.exports="/assets/8068c1873bb18d03.svg"},733427:function(e,t,n){n.d(t,{Z:()=>c});var r=n(192379);let c=()=>{let e=r.useRef(!0);return r.useEffect(()=>()=>{e.current=!1},[]),r.useCallback(()=>e.current,[])}},169382:function(e,t,n){n.d(t,{l:()=>o}),n(610138),n(216116),n(78328),n(815648),n(47120);var r=n(192379),c=n(512969);function o(){let e=(0,c.TH)();return r.useMemo(()=>new URLSearchParams(e.search),[e.search])}},832462:function(e,t,n){n.r(t),n.d(t,{default:()=>f}),n(757143);var r=n(200651),c=n(192379),o=n(593473),l=n(512969),i=n(478677),a=n(457330),s=n(675207),u=n(981631);function d(e){let{platformType:t}=e,n=(0,l.k6)();return c.useEffect(()=>{let{code:e,state:r}=o.parse(window.location.search),c="".concat(u.Z5c.CONNECTIONS_ERROR(t)).concat(window.location.search);if(null==e||null==r){n.replace(c);return}a.Z.linkDispatchAuthCallback(t,{code:e,state:r}).then(e=>{let{status:r}=e;204===r?n.replace(u.Z5c.CONNECTIONS_SUCCESS(t)):n.replace(c)},()=>{n.replace(c)})},[n,t]),(0,r.jsx)(s.VerifyAccountLoading,{platformType:t})}let f=function(e){let{match:t}=e,n=t.params.type,{two_way_link_type:c}=o.parse(window.location.search);return[u.ABu.XBOX,u.ABu.PLAYSTATION_STAGING,u.ABu.PLAYSTATION,u.ABu.CRUNCHYROLL].includes(n)&&c===i.g.DESKTOP?(0,r.jsx)(d,{platformType:n}):null}},656649:function(e,t,n){n.d(t,{KJ:()=>d,UV:()=>u,vJ:()=>s});var r=n(200651);n(192379);var c=n(120356),o=n.n(c),l=n(726542),i=n(981631),a=n(490730);function s(e){return null!=e&&Object.values(i.ABu).includes(e)?e:null}function u(e){let{children:t,platformType:n}=e,c=l.Z.get(n);return(0,r.jsx)("div",{className:a.verifyConnectedAccount,children:(0,r.jsxs)("div",{children:[(0,r.jsx)(d,{platform:c}),t]})})}function d(e){let{platform:t,className:n}=e;return(0,r.jsxs)("div",{className:o()(a.logos,n),children:[(0,r.jsx)("div",{className:o()(a.logo,a.logoDiscord)}),(0,r.jsx)("div",{className:a.logosDivider}),(0,r.jsx)("div",{className:a.logo,style:{backgroundImage:'url("'.concat(t.icon.whiteSVG,'")')}})]})}},675207:function(e,t,n){n.r(t),n.d(t,{VerifyAccountDeekLink:()=>_,VerifyAccountLoading:()=>E,default:()=>m}),n(47120),n(757143),n(773603);var r=n(200651),c=n(192379),o=n(512969),l=n(873546),i=n(604039),a=n(481060),s=n(457330),u=n(733427),d=n(169382),f=n(726542),p=n(536285),N=n(591759),C=n(656649),O=n(981631),g=n(388032),v=n(636662);let S=null!=window.opener;function m(){var e,t;let n=(0,o.k6)(),a=(0,d.l)(),p=a.get("code"),g=a.get("oauth_verifier"),v=null!==(e=a.get("state"))&&void 0!==e?e:"",m=a.get("loading"),b=null!==(t=a.get("iss"))&&void 0!==t?t:void 0,{type:A}=(0,o.UO)(),T=(0,C.vJ)(A),[x,w]=c.useState(!1),[Z,j]=c.useState(!1),k=(0,u.Z)(),D=null==g?null!=p?p:"":g;c.useEffect(()=>{let e;if(null!=m)return;for(let t of a.keys())t.startsWith("openid.")&&(null==e&&(e={}),e[t]=a.get(t));let t=(0,C.vJ)(A);(async function(){if(null==t||!f.Z.isSupported(t))return;function r(e){let{status:r,body:c}=e;if(null!=t){if(null==c?void 0:c.redirect){window.location=c.redirect;return}if([200,204].includes(r)){n.replace(O.Z5c.CONNECTIONS_SUCCESS(t)),S&&window.close();return}(null==c?void 0:c.code)!=null&&a.append("error-code",c.code),n.replace("".concat(O.Z5c.CONNECTIONS_ERROR(t),"?").concat(a.toString()))}}if(await h({platformType:t,code:D,state:v,openidParams:e,iss:b,handleCallbackResponse:r}))return;let c=await R(t,v,D,e,b);if(0===c){w(!0);return}if(1===c){n.replace("".concat(O.Z5c.CONNECTIONS_ERROR(t),"?").concat(a.toString()));return}if(3===c){if(l.tq){j(!0);return}n.replace("".concat(O.Z5c.CONNECTIONS_ERROR(t),"?").concat(a.toString()));return}y({platformType:t,state:v,handleCallbackResponse:r,handleCallbackError:()=>{n.replace("".concat(O.Z5c.CONNECTIONS_ERROR(t),"?").concat(a.toString()))},openidParams:e,code:D,iss:b})})()},[D,n,m,A,a,v,b]),c.useEffect(()=>{let e;if(!x)return;let t=0;async function r(){if(null==T)return;let{handoff_status:c,success_redirect:o}=(await s.Z.getHandoffStatus(T,v)).body;if(c===i.g.HANDOFF_SUCCESS)return null==N.Z.toURLSafe(o)?n.replace(O.Z5c.CONNECTIONS_SUCCESS(T)):(window.location=o,void 0);if(c===i.g.HANDOFF_ERROR||t>=10)return n.replace(O.Z5c.CONNECTIONS_ERROR(T));e=setTimeout(()=>{k()&&(t+=1,r())},1e3)}return r(),()=>{null!=e&&clearTimeout(e)}},[k,n,T,x,v]);let I=c.useMemo(()=>{if(null!=T)return"discord://".concat(O.Z5c.CONNECTIONS(T),"/?").concat(a.toString())},[T,a]);return null!=T&&f.Z.isSupported(T)?Z?(0,r.jsx)(_,{platformType:T,deeplink:I,onClick:()=>{j(!1),w(!0)}}):(0,r.jsx)(E,{platformType:T}):null}function E(e){let{platformType:t}=e,n=f.Z.get(t);return(0,r.jsxs)(C.UV,{platformType:t,children:[(0,r.jsx)("div",{className:v.message,children:g.intl.format(g.t.AOKOe3,{name:n.name})}),(0,r.jsx)("div",{className:v.buttonContainer,children:(0,r.jsx)(a.zxk,{className:v.btn,disabled:!0,children:(0,r.jsx)(a.$jN,{itemClassName:v.spinnerItem})})})]})}function _(e){let{deeplink:t,onClick:n,platformType:c}=e,o=f.Z.get(c);return(0,r.jsx)(C.UV,{platformType:c,children:(0,r.jsxs)("div",{className:v.buttonContainer,children:[(0,r.jsx)("div",{className:v.message,children:g.intl.format(g.t["6ig6i4"],{connectionName:o.name})}),(0,r.jsx)(a.P3F,{tag:"a",href:t,onClick:n,target:"_self",children:(0,r.jsx)(a.zxk,{className:v.btn,children:g.intl.string(g.t.flvacH)})})]})})}async function h(e){let{platformType:t,code:n,state:r,openidParams:c,iss:o,handleCallbackResponse:i}=e;if(l.tq||S)return!1;try{let e=await p.default.request(O.Etm.CONNECTIONS_CALLBACK,{code:n,openid_params:c,iss:o,state:r,providerType:t}).finally(()=>{p.default.disconnect()});return i(e),!0}catch(e){return!1}}async function R(e,t,n,r,c){try{return await s.Z.sessionHandoff(e,t,n,r,c),0}catch(e){var o,l;if((null==e?void 0:null===(o=e.body)||void 0===o?void 0:o.code)===10020)return 2;if((null==e?void 0:null===(l=e.body)||void 0===l?void 0:l.code)===40001)return 3;return 1}}async function y(e){let{platformType:t,state:n,handleCallbackResponse:r,handleCallbackError:c,openidParams:o,code:l,iss:i}=e;try{let e=await s.Z.callback(t,{code:l,openid_params:o,state:n,iss:i},!S);return r(e),!0}catch(e){return c(),!0}}},604039:function(e,t,n){n.d(t,{g:()=>c});var r,c=((r={})[r.HANDOFF_AUTHORIZED=0]="HANDOFF_AUTHORIZED",r[r.HANDOFF_ERROR=1]="HANDOFF_ERROR",r[r.HANDOFF_SUCCESS=2]="HANDOFF_SUCCESS",r)},478677:function(e,t,n){n.d(t,{g:()=>c}),n(47120);var r,c=((r={}).MOBILE="mobile",r.DESKTOP="desktop",r.WEB="web",r.DEVICE_CODE="device_code",r)},490730:function(e,t,n){e.exports={verifyConnectedAccount:"verifyConnectedAccount_fb52a4",logos:"logos_fb52a4",logosDivider:"logosDivider_fb52a4",logo:"logo_fb52a4",logoDiscord:"logoDiscord_fb52a4"}},636662:function(e,t,n){e.exports={buttonContainer:"buttonContainer_eeed5f",message:"message_eeed5f",btn:"btn_eeed5f",spinnerItem:"spinnerItem_eeed5f"}}}]);
//# sourceMappingURL=6cab6d8e9c463e64.js.map